pipeline {
    agent any

    stages {
        stage('Git-Checkout') {
            steps {
                echo "Start Git Checkout"
                // Get some code from a GitHub repository
                git credentialsId: 'JayanthGitHub', url: 'https://github.com/TJayanth/MVC-CRUD.git'
                
            }
        }
        stage('Restore packages'){
               steps{
                   echo "Restore Package"
                   bat 'dotnet restore MVCCRUD.sln'
                 }
        }
        stage('Clean'){
           steps{
               bat "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\msbuild.exe ${workspace}\\MVCCRUD.sln /nologo /nr:false /p:platform=\"x64\" /p:configuration=\"release\" /t:clean"
               //bat 'dotnet clean MVCCRUD.sln --configuration Release'
            }
         }
        stage('Build'){
           steps{
               bat "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\msbuild.exe ${workspace}\\MVCCRUD.sln /nologo /nr:false  /p:platform=\"x64\" /p:configuration=\"release\" /p:PackageCertificateKeyFile=<path-to-certificate-file>.pfx /t:clean;restore;rebuild"
               //bat 'dotnet build MVCCRUD.sln --configuration Release --no-restore'
            }
         }

         stage('Release'){
           steps{
               echo "Ready for release"
            }
         }
    }
}
