pipeline {
    agent any

    stages {
        stage('Git-Checkout') {
            steps {
                echo "Start Git Checkout"
                // Get some code from a GitHub repository
                 git credentialsId: '4edc916e-d436-47bf-a0d8-775199bfa17d', url: 'https://github.com/TJayanth/MVC-CRUD.git'
                
            }
        }
        stage('Restore packages'){
               steps{
                   echo "Restore Package"
                    // bat "D:\\MSBuild_2019\\MsBuild.exe MVCCRUD.sln /p:Configuration=Release /p:Platform=\"Any CPU\" /t:nugetrestore"
                    // bat "\"${tool 'MsBuild'}\"\\MsBuild.exe C:\\ProgramData\\Jenkins\\.jenkins\\workspace\\mvccrud_multibranch_1_master\\MVCCRUD.sln /p:Configuration=Release /p:Platform=\"Any CPU\" /t:nugetrestore"
                   //bat 'dotnet restore MVCCRUD.sln'
                 }
        }
        stage('Clean'){
           steps{
               bat "\"${tool 'MsBuild'}\"\\MsBuild.exe MVCCRUD.sln /p:Configuration=Release /p:Platform=\"Any CPU\" /t:Clean;Rebuild"
            //    bat "D:\\MSBuild_2019\\MsBuild.exe MVCCRUD.sln /p:Configuration=Release /p:Platform=\"Any CPU\" /t:Clean;Rebuild"
            //    bat "D:\\MSBuild_2019\\MsBuild.exe MVCCRUD.sln /p:Configuration=Release /p:Platform=\"Any CPU\" /t:Clean;Rebuild"
               //bat 'dotnet clean MVCCRUD.sln --configuration Release'
            }
         }
        stage('Build'){
           steps{
               echo "Build"
               //bat "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\msbuild.exe MVCCRUD.sln /nologo /nr:false  /p:platform=\"x64\" /p:configuration=\"release\" /p:PackageCertificateKeyFile=<path-to-certificate-file>.pfx /t:clean;restore;rebuild"
               //bat 'dotnet build MVCCRUD.sln --configuration Release --no-restore'
            }
         }

         stage('Release'){
           steps{
               echo "Ready for release"
            }
         }
    }
}
